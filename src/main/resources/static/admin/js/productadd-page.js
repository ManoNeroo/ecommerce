const FORM_ADD=document.getElementById("form-add"),NAME_INPUT=FORM_ADD.querySelector("input[name='name']"),PRICE_INPUT=FORM_ADD.querySelector("input[name='price']"),PRICEOFF_INPUT=FORM_ADD.querySelector("input[name='priceOff']"),QUANLITY_INPUT=FORM_ADD.querySelector("input[name='quanlity']"),NAME_ERROR=FORM_ADD.querySelector(".name-error"),PRICE_ERROR=FORM_ADD.querySelector(".price-error"),PRICEOFF_ERROR=FORM_ADD.querySelector(".priceoff-error"),QUANLITY_ERROR=FORM_ADD.querySelector(".quanlity-error");async function handleSaveProduct(e){e.preventDefault();const r=getFormData(FORM_ADD);if(validateForm(r)){const e={brandId:Number(r.brandId),categoryId:Number(r.categoryId),name:r.name,status:JSON.parse(r.status),avatar:"/common/mylib/img/product-avatar.jpg",quanlity:Number(r.quanlity.replace(/,/g,"")),price:Number(r.price.replace(/,/g,"")),priceOff:Number(r.priceOff.replace(/,/g,""))},t=await httpClient("/api/product","POST",e);if(t.isSuccess){let e=window.location.origin;window.location.href=e+"/admin/product/edit/"+t.data.id}else showAlert("failed","Lỗi","Thêm sản phẩm thất bại!")}}function validateForm(e){let{name:r,price:t,quanlity:n,priceOff:i}=e;r=r.trim(),t=t.replace(/,/g,""),i=i.replace(/,/g,""),n=n.replace(/,/g,"");let a=!0;return""==r?(NAME_ERROR.innerText="Nhập tên sản phẩm!",a=!1):/^[a-z][-a-z@:%\._\/+~#=\d\s)(]{2,}$/gi.test(removeAccent(r))||(NAME_ERROR.innerText="Tên sản phẩm không hợp lệ!",a=!1),""==t&&(PRICE_ERROR.innerText="Nhập giá sản phẩm!",a=!1),""==n&&(QUANLITY_ERROR.innerText="Nhập số lượng sản phẩm!",a=!1),Number(i)>Number(t)&&(PRICEOFF_ERROR.innerText="Giá khuyến mãi không hợp lệ!",a=!1),a}NAME_INPUT.addEventListener("focus",()=>NAME_ERROR.innerText=""),PRICE_INPUT.addEventListener("focus",()=>PRICE_ERROR.innerText=""),PRICEOFF_INPUT.addEventListener("focus",()=>PRICEOFF_ERROR.innerText=""),QUANLITY_INPUT.addEventListener("focus",()=>QUANLITY_ERROR.innerText=""),FORM_ADD.addEventListener("submit",handleSaveProduct),numberInput();